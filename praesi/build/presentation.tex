 %***************************************************************************%
 % Thesis presentation                                                       %
 %                                                                           %
 %                                                                           %
 %                        B A C H E L O R   T H E S I S                      %
 %                                                                           %
 %                                                                           %
 %  Title:           Template for Making Presentation with LaTeX             %
 %                                                                           %
 %  Author:                         Andrey Popov                             %
 %                                                                           %
 %  Supervisor:                     MSc. A. Popov                            %
 %                                                                           %
 %  Date:                            29.08.2007                              %
 %                                                                           %
 %***************************************************************************%

 %   Template - Institute of Control Systems, Hamburg University of Technology
 %
 %   A. Popov
 %
 %   Updates:  AP: 29.08.2007;  AP: 17.09.2007; AP: 16.06.2009
 %
 %   Version 0.3


 %##########################################
 %     R E A D      M E     F I R S T  !
 %##########################################
 % beamer package and manual can be downloaded from  %
 % http://tug.ctan.org/cgi-bin/ctanPackageInformation.py?id=powerdot
 %
 % Possible compilation processes:
 % LaTeX -> DVI -> PS -> PDF   [recomended]
 % LaTeX -> pdfTeX -> PDF
 %##########################################


 %------------------------------------------
 % INFO:   Presentation Time
 %------------------------------------------
 % Studienarbeit:                     20 min
 % Bachelor thesis, Master thesis,
 % Diplomarbeit:                      30 min 
 %------------------------------------------


 %%################ Document  settings ###################
\include{header}    % make all adjustments to language and packages here


\title{The Tortoise and the Hare, Restart GMRES}

\author[Moritz Wolter]{Moritz Wolter \texorpdfstring{\\}{} {\small\texttt{moritzalexander.wolter @ student.kuleuven.de}}}


%\institute{
%	Ku Leuven\\ Numerical Linear Algebra 
%}

%\date[\today]{Template presentation \\ 19.08.2007}
 % (optional, should be abbreviation of conference name)

\subject{Pseudospektren}

% This makes a table of contents at the begining of each section. This is used to show where you are in the presentation and for navigation.
\AtBeginSection[]
{
  \begin{frame}<beamer>{Contents}
    \tableofcontents[currentsection,hideallsubsections]
  \end{frame}
}


%#######################BEGIN THE PRESENTATION #######################
\begin{document}

 % Title page
\begin{frame}\titlepage
\end{frame}

 % Table of contents (used also for navigation)
\begin{frame}{Contents}
  \tableofcontents[hideallsubsections]
\end{frame}

% Delete this, if you do not want the table of contents to pop up at
% the beginning of each subsection:
\AtBeginSection[]
{
  \begin{frame}<beamer>{Contents}
    \tableofcontents[currentsection,hideallsubsections]
  \end{frame}
}
\section{Recap GMRES}
\begin{frame}
\frametitle{Recap \texttt{GMRES(m)}}
  \begin{enumerate}
  \item Start: Choose $x_0$ and compute $r_0 = f - Ax_0$ and $v_1 = r_0/\|r_0\|$ 
  \item Iterate: For j = 1,2,\dots,m do \\
        $h_{i,j} = (Av_j,v_i), i = 1,\dots,j $\\
        $\hat{v}_{j+1} = Av_j  - \sum_{i=1}^{j} h_{i,j}v_{i}$ \\
        $h_{j+1,j} = \| \hat{v}_{j+1} \| $, and \\
        $v_{j+1} =  \hat{v}_{j+1} / {h}_{j+1,j} $ \\
  \item Form the approximate solution:
        $x_m = x_0 + V_m y_m$ where $y_m$ minimizes $\| \beta e_1 - H_m y \|, y\in \mathbb{R}^m$
  \item Restart:
        Compute $r_m = f - Ax_m$; if satisfied stop, else
        $x_0 = x_m, v_1 = r_m/\|r_m\|$
  
  \end{enumerate}
  
  
\end{frame}

\section{The Problem}
\begin{frame}
  \frametitle{GMRES(\texttt{m}) convergence}
	\begin{figure}
		\input{../images/randGMRESTwoInOne.tex}
		\caption{GMRES(\texttt{m}) convergence on large random matrix $\mathbf{A}$ of dimension 60 with $\mathbf{b} = [0 \dots 1 \dots 0]^T$ in blocks of 20 each.}
    \end{figure}
  
\end{frame}



\begin{frame}
\begin{eqnarray}
\mathbf{A}_1 =
\begin{pmatrix}
1 & 1 & 1 \\
0 & 1 & 3 \\
0 & 0 & 1 \\
\end{pmatrix}
\mathbf{b}_1 =
\begin{pmatrix}
2 \\ -4 \\ 1 \\
\end{pmatrix} \\
\mathbf{A}_2 =
\begin{pmatrix}
1 & 2 & -2 \\
0 & 2 & 4 \\
0 & 0 & 3 \\
\end{pmatrix}
\mathbf{b}_2 =
\begin{pmatrix}
3 \\ 1 \\ 1 \\
\end{pmatrix}
\end{eqnarray}
\end{frame}


\begin{frame}
	\frametitle{Gmres convergence}	
	\begin{figure}
		\input{../images/fig1Conv.tex}
		\caption{\texttt{GMRES} convergence on matrix $\mathbf{A}_1. $}
    \end{figure}
\end{frame}

\begin{frame}
	\begin{figure}
			\input{../images/fig1Conv.tex}
			\caption{\texttt{GMRES} convergence on matrix $\mathbf{A}_2$.}
	\end{figure}
\end{frame}



\section{The problem in 2d}
\begin{frame}
	\frametitle{Convergence in a two dimesional plane}
	\begin{figure}
	\centering
	\includegraphics[width=0.45\linewidth]{../images/fig4Matp2}
	\includegraphics[width=0.45\linewidth]{../images/fig4Matp1}
	\caption{Residual magnitude Plot for matrix $\mathbf{A}_2, \mathbf{b}_2$, as seen in the Embree paper for GMRES(1)(left) and GMRES(2)(right) in figure 4.}
	\label{fig:fig4}
	\end{figure}
\end{frame}

\begin{frame}
\frametitle{Convergence in a two dimesional plane}
\begin{figure}
\centering
\includegraphics[width=0.45\linewidth]{../images/fig2Matp1}
\includegraphics[width=0.45\linewidth]{../images/fig2Matp2}
\caption{Residual magnitude Plot for the $\mathbf{A}_1,\mathbf{b}_1 $ pair, as seen in the Embree paper GMRES(1)(left) and GMRES(2)(right) in figure two.}
\label{fig:fig2}
\end{figure}
\end{frame}


\begin{frame}
\frametitle{Conditioning makes a difference.}
	\begin{figure}
	\centering
	\includegraphics[width=0.45\linewidth]{../images/Am0p35eyeGMRES1}
	\includegraphics[width=0.45\linewidth]{../images/Am0p35eyeGMRES2}
	\caption{\texttt{GMRES(1)} and \texttt{GMRES(2)} convergence on $\mathbf{A} - 0.35 \cdot \mathbf{I}$. $\kappa(\mathbf{A}) = 14.2950$ changes to $\kappa(\mathbf{A} - 0.35 \cdot \mathbf{I}) = 39.1873$.} 
	\label{fig:modA}
	\end{figure}
\end{frame}

\begin{frame}
\frametitle{A random matrix.}
\begin{equation}
\mathbf{R} = \begin{pmatrix}
-0.3034 &   0.8884 &  -0.8095 \\
 0.2939 &  -1.1471 &  -2.9443 \\
-0.7873 &  -1.0689 &   1.4384 \\
\end{pmatrix} 
\end{equation}
\end{frame}
%b comes from the complex plane!

\begin{frame}
\begin{figure}
\centering
\includegraphics[width=0.45\linewidth]{../images/randAGMRES1}
\includegraphics[width=0.45\linewidth]{../images/randAGMRES2}
\caption{Convergence of \texttt{GMRES(1)}(left) and \texttt{GMRES(2)}(right) for the random matrix $\mathbf{R}$. $\kappa(\mathbf{R}) = 5.1025$ }
\label{fig:randAGMRES2}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\centering
\includegraphics[width=0.45\linewidth]{../images/randAp2eyeGMRES1}
\includegraphics[width=0.45\linewidth]{../images/randAp2eyeGMRES2}
\caption{Convergence results for $\mathbf{R} + 2\mathbf{I}$. $\kappa(\mathbf{R} + 2\mathbf{I}) = 77.5446$. }
\label{fig:randAp2eyeGMRES2}
\end{figure}
\end{frame}
\begin{frame}
\begin{figure}
\centering
\includegraphics[width=0.45\linewidth]{../images/randAp3eyeGMRES2}
\includegraphics[width=0.45\linewidth]{../images/randAp3eyeGMRES2}
\caption{Convergence results for $\mathbf{R} + 3\mathbf{I}$. $\mathbf{R} + 3\mathbf{I} = 6.4262$.}
\label{fig:randAp3eyeGMRES2}
\end{figure}
\end{frame}


\begin{frame}
 \begin{equation}
 \mathbf{C} = \begin{pmatrix}
 1 & -2 \\
 0 & 1 \\
 \end{pmatrix}
 \;\;\;
 \mathbf{r_0} = \begin{pmatrix} \xi \\ \eta \end{pmatrix}
 \end{equation}
\end{frame}

\begin{frame}
\begin{figure}
\centering
\includegraphics[width=0.45\linewidth]{../images/twoDPaper}
\includegraphics[width=0.45\linewidth]{../images/twoDZoom}
\caption{A plot of the convergence plain for the matrix $\mathbf{C}$ proposed at the end of Embree's paper. With zoom on an interesting region.}
\label{fig:twoDZoom}
\end{figure}
\end{frame}

\section{More on the noise}
\begin{frame}
\begin{figure}
\centering
\includegraphics[width=1\linewidth]{../images/gmresCHist}
\caption{Convergence Plain and error histogram for matrix $\mathbf{C}$.}
\end{figure}
\end{frame}


\begin{frame}
\begin{itemize}
\item  $\mathcal{D}_1 = 10^{-1} + \| \mathcal{N}(0,2.5 \cdot 10^{-3}) \| $ \\
\item  $\mathcal{D}_2 = 10^{-5} + \| \mathcal{N}(0,2.5 \cdot 10^{-3}) \| $ \\
\end{itemize}

\begin{figure}
\centering
\includegraphics[width=1\linewidth]{../images/randnHist}
\caption{Plots of the distributions generated by
\texttt{d1 = 0.00001 + 0.05*abs(randn(10000,1));
d2 = 0.1 + 0.05*abs(randn(10000,1));} . The last plot is on a semilogarithmic scale. }
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\centering
\includegraphics[width=1\linewidth]{../images/gmresBHist}
\caption{Convergence Plain and error histogram for matrix $\mathbf{B}$.}
\end{figure}
\end{frame}

\section{Stagnation condition}
\begin{frame}
\centering
\frametitle{Recurrence for \texttt{gmres(1)}.}
\begin{equation}
\mathbf{r}_{k + 1}^{(1)} = \mathbf{r}_k^{(1)} - \frac{\mathbf{r}_k^{(1)T} \mathbf{A} \mathbf{r}_k^{(1)}}{\mathbf{r}_k^{(1)T} \mathbf{A}^T \mathbf{A} \mathbf{r}_k^{(1)}} \mathbf{A} \mathbf{r}_k^{(1)}
\end{equation}
$\Rightarrow$ \texttt{gmres(1)} must stagnate if $\mathbf{r}_k^{(1)T} \mathbf{A} \mathbf{r}_k^{(1)} = 0$.
\end{frame}

\begin{frame}
\begin{figure}
\frametitle{Matrix $\mathbf{A}$}
\centering
\includegraphics[width=0.7\linewidth]{../images/gmresOneConvA}
\caption{Region of guaranteed convergence with \texttt{gmres(1)} on matrix $\mathbf{A}$.}
\label{fig:gmresOneConvA}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}
\frametitle{Matrix $\mathbf{B}$}
\centering
\includegraphics[width=0.7\linewidth]{../images/gmresOneConvB}
\caption{Region of guaranteed convergence with \texttt{gmres(1)} on matrix $\mathbf{B}$.}
\label{fig:gmresOneConvB}
\end{figure}
\end{frame}

\end{document}
