

clear all
load reg.mat;
A = {A1, A2, A3, A4, A5, A6};
b = {berr1, berr2;
A = A2;
b = berr2;
A = A3;
b = berr3;
A = A3;
b = berr3;
A = A3;
b = berr3;
A = A3;
b = berr3;


[U,S,V] = svd(A);
f = logspace(log10(S(1,1)),log10(S(end,end)),1000);
gcvVals = zeros(length(f),1);

for i = 1:length(f)
   gcvVals(i) =  gcv( f(i),U,S,V,A,b );    
end

fPick = fminbnd(@(f) gcv(f,U,S,V,A,b),S(end,end),S(1,1));
[~,IPick] = min(abs(f-fPick));


loglog(f,gcvVals)
hold on
loglog(fPick,gcv(fPick,U,S,V,A,b),'*')